{"version":3,"sources":["MainComponent.tsx"],"names":["MainComponent","_props","ref","state","dispatch","rootReducer","rootState","phoneNumber","setPhoneNumber","countryCode","setCountryCode","loginVisible","setLoginVisible","loginOTPVisible","setLoginOTPVisible","webLoginUrl","setWebLoginUrlToView","webLoginModalVisible","setWebLoginModalVisible","clearState","loginRequest","params","loginAction","loginOTPRequest","loginOTPAction","webLoginRequest","webLoginAction","getWebLogin","baseUrl","endPointUrl","response","fetch","method","headers","options","clientSecret","clientId","body","JSON","stringify","json","data","console","error","message","EventRegister","emitEvent","ON_ERROR","resetReducer","type","React","useImperativeHandle","logIn","lang","forwardRef"],"mappings":"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","sourcesContent":["import React, {useReducer} from 'react';\nimport {Context} from '../core/Context';\nimport {checkClient} from '../helpers';\nimport useGlobalState from '../core/useGlobalState';\nimport rootReducer from '../models/rootReducer';\nimport rootState from '../models/rootState';\nimport {LoginOTPRequest, LoginRequest, WebLoginRequest} from '../models/models.interface';\nimport {loginAction} from '../models/loginModel';\nimport {loginOTPAction} from '../models/loginOTPModel';\nimport {IMainComponent} from '../core/core.interface';\nimport {webLoginAction} from \"../models/webLoginModel\";\nimport WebLogin from \"./WebLogin\";\nimport {EventRegister, ON_ERROR} from \"../core/eventManager\";\nimport options from \"../core/options\";\n\nconst MainComponent: IMainComponent = (_props, ref): React.ReactElement => {\n    checkClient();\n\n    const [state, dispatch] = useReducer(rootReducer, rootState);\n    const {\n        phoneNumber,\n        setPhoneNumber,\n        countryCode,\n        setCountryCode,\n        loginVisible,\n        setLoginVisible,\n        loginOTPVisible,\n        setLoginOTPVisible,\n        webLoginUrl,\n        setWebLoginUrlToView,\n        webLoginModalVisible,\n        setWebLoginModalVisible,\n        clearState\n    } = useGlobalState();\n\n    const loginRequest = async (params: LoginRequest) => {\n        await loginAction.loginRequest(dispatch, params);\n    };\n\n    const loginOTPRequest = async (params: LoginOTPRequest) => {\n        await loginOTPAction.loginOTPRequest(dispatch, params);\n    };\n\n    const webLoginRequest = async (params: WebLoginRequest) => {\n        await webLoginAction.webLoginRequest(dispatch, params);\n    };\n\n    const getWebLogin = async (params: WebLoginRequest) => {\n        try {\n            setWebLoginModalVisible(true);\n            let baseUrl = 'https://api.human-id.org/v1/';\n            let endPointUrl = 'mobile/users/web-login';\n            const response = await fetch(baseUrl + endPointUrl, {\n                method: 'POST',\n                headers: {\n                    'content-type': 'application/json',\n                    'client-secret': options.clientSecret,\n                    'client-id': options.clientId,\n                },\n                body: JSON.stringify(params),\n            });\n            const json = await response.json();\n            if (json.data != null) {\n                setWebLoginUrlToView(json.data.webLoginUrl);\n            } else {\n                setWebLoginModalVisible(false);\n                console.error(json.message);\n                EventRegister.emitEvent(ON_ERROR, json.message);\n            }\n        } catch (error) {\n            setWebLoginModalVisible(false);\n            EventRegister.emitEvent(ON_ERROR, 'Login Failed');\n        }\n    };\n\n    const resetReducer = () => {\n        dispatch({\n            type: \"RESET\"\n        });\n    };\n\n    React.useImperativeHandle(ref, () => ({\n        logIn: () => getWebLogin({\n            lang: 'en'\n        })\n    }));\n\n    return (\n        <Context.Provider\n            value={{\n                state,\n                loginRequest,\n                loginOTPRequest,\n                webLoginRequest,\n                resetReducer,\n                phoneNumber,\n                setPhoneNumber,\n                countryCode,\n                setCountryCode,\n                loginVisible,\n                setLoginVisible,\n                loginOTPVisible,\n                setLoginOTPVisible,\n                webLoginModalVisible,\n                setWebLoginModalVisible,\n                webLoginUrl,\n                setWebLoginUrlToView,\n                clearState\n            }}>\n            <WebLogin />\n        </Context.Provider>\n    );\n};\n\nexport default React.forwardRef(MainComponent);\n"]}