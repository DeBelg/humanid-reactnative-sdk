{"version":3,"sources":["index.tsx"],"names":["WebLogin","webLoginModalVisible","setWebLoginModalVisible","clearState","resetReducer","webLoginUrl","Context","handleOnCancel","EventRegister","emitEvent","ON_CANCEL","isLoading","setLoading","handleEventFromWebLogin","url","includes","ON_ERROR","exchangeToken","split","ON_SUCCESS","styles","modal","container","toolbar","flex","uri","syntheticEvent","nativeEvent"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;;;;;;;AAOA,SAASA,QAAT,GAAiC;AAC/B,QAAM;AACJC,IAAAA,oBADI;AAEJC,IAAAA,uBAFI;AAGJC,IAAAA,UAHI;AAIJC,IAAAA,YAJI;AAKJC,IAAAA;AALI,MAMF,uBAAWC,gBAAX,CANJ;;AAQA,QAAMC,cAAc,GAAG,MAAM;AAC3BC,gCAAcC,SAAd,CAAwBC,uBAAxB,EAAmC,IAAnC;;AACAN,IAAAA,YAAY;AACZD,IAAAA,UAAU;AACX,GAJD;;AAMA,QAAM,CAACQ,SAAD,EAAYC,UAAZ,IAA0B,qBAAS,IAAT,CAAhC;;AAEA,QAAMC,uBAAuB,GAAIC,GAAD,IAAiB;AAC/C,QAAIA,GAAG,CAACC,QAAJ,CAAa,QAAb,CAAJ,EAA4B;AAC1BP,kCAAcC,SAAd,CAAwBO,sBAAxB,EAAkC,cAAlC;;AACAd,MAAAA,uBAAuB,CAAC,KAAD,CAAvB;AACD;;AACD,QAAIY,GAAG,CAACC,QAAJ,CAAa,UAAb,CAAJ,EAA8B;AAC5B,UAAIE,aAAa,GAAGH,GAAG,CAACI,KAAJ,CAAU,KAAV,EAAiB,CAAjB,CAApB;;AACAV,kCAAcC,SAAd,CAAwBU,wBAAxB,EAAoCF,aAApC;;AACAf,MAAAA,uBAAuB,CAAC,KAAD,CAAvB;AACD;;AACD,QAAIY,GAAG,CAACC,QAAJ,CAAa,UAAb,CAAJ,EAA8B;AAC5BP,kCAAcC,SAAd,CAAwBO,sBAAxB,EAAkCF,GAAlC;;AACAZ,MAAAA,uBAAuB,CAAC,KAAD,CAAvB;AACD;;AACD,QAAIY,GAAG,CAACC,QAAJ,CAAa,MAAb,CAAJ,EAA0B;AACxBP,kCAAcC,SAAd,CAAwBC,uBAAxB,EAAmC,EAAnC;;AACAR,MAAAA,uBAAuB,CAAC,KAAD,CAAvB;AACD;AACF,GAlBD;;AAoBA,sBACI,yEACE,6BAAC,kBAAD;AACI,IAAA,KAAK,EAAEkB,gBAAOC,KADlB;AAEI,IAAA,OAAO,EAAEpB,oBAFb;AAGI,IAAA,cAAc,EAAEM;AAHpB,kBAIE,6BAAC,iBAAD;AAAM,IAAA,KAAK,EAAEa,gBAAOE;AAApB,kBACE,6BAAC,iBAAD;AAAM,IAAA,KAAK,EAAEF,gBAAOG;AAApB,IADF,eAEE,6BAAC,2BAAD;AACI,IAAA,KAAK,EAAE;AAACC,MAAAA,IAAI,EAAE;AAAP,KADX;AAEI,IAAA,MAAM,EAAE;AACNC,MAAAA,GAAG,EAAEpB;AADC,KAFZ;AAKI,IAAA,WAAW,EAAE,MAAM;AACjBO,MAAAA,UAAU,CAAC,IAAD,CAAV;AACD,KAPL;AAQI,IAAA,SAAS,EAAEc,cAAc,IAAI;AAC3B,YAAM;AAACC,QAAAA;AAAD,UAAgBD,cAAtB;AACAb,MAAAA,uBAAuB,CAACc,WAAW,CAACb,GAAb,CAAvB;AACAF,MAAAA,UAAU,CAAC,KAAD,CAAV;AACD;AAZL,IAFF,eAgBE,6BAAC,qBAAD;AAAc,IAAA,OAAO,EAAED;AAAvB,IAhBF,CAJF,CADF,CADJ;AA2BD;;eAEcX,Q","sourcesContent":["import React, {useContext, useState} from 'react';\nimport {View, Modal} from 'react-native';\nimport styles from './styles';\nimport ModalLoading from './ModalLoading';\nimport {Context} from '../../core/Context';\nimport WebView from 'react-native-webview';\nimport {\n  EventRegister,\n  ON_CANCEL,\n  ON_ERROR,\n  ON_SUCCESS,\n} from '../../core/eventManager';\n\nfunction WebLogin(): JSX.Element {\n  const {\n    webLoginModalVisible,\n    setWebLoginModalVisible,\n    clearState,\n    resetReducer,\n    webLoginUrl,\n  } = useContext(Context);\n\n  const handleOnCancel = () => {\n    EventRegister.emitEvent(ON_CANCEL, true);\n    resetReducer();\n    clearState();\n  };\n\n  const [isLoading, setLoading] = useState(true);\n\n  const handleEventFromWebLogin = (url: string) => {\n    if (url.includes('/error')) {\n      EventRegister.emitEvent(ON_ERROR, 'Login Failed');\n      setWebLoginModalVisible(false);\n    }\n    if (url.includes('/success')) {\n      let exchangeToken = url.split('et=')[1];\n      EventRegister.emitEvent(ON_SUCCESS, exchangeToken);\n      setWebLoginModalVisible(false);\n    }\n    if (url.includes('code=500')) {\n      EventRegister.emitEvent(ON_ERROR, url);\n      setWebLoginModalVisible(false);\n    }\n    if (url.includes('back')) {\n      EventRegister.emitEvent(ON_CANCEL, '');\n      setWebLoginModalVisible(false);\n    }\n  };\n\n  return (\n      <>\n        <Modal\n            style={styles.modal}\n            visible={webLoginModalVisible}\n            onRequestClose={handleOnCancel}>\n          <View style={styles.container}>\n            <View style={styles.toolbar} />\n            <WebView\n                style={{flex: 1}}\n                source={{\n                  uri: webLoginUrl,\n                }}\n                onLoadStart={() => {\n                  setLoading(true);\n                }}\n                onLoadEnd={syntheticEvent => {\n                  const {nativeEvent} = syntheticEvent;\n                  handleEventFromWebLogin(nativeEvent.url);\n                  setLoading(false);\n                }}\n            />\n            <ModalLoading visible={isLoading} />\n          </View>\n        </Modal>\n      </>\n  );\n}\n\nexport default WebLogin;\n"]}